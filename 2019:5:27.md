# 2019/5/27　日報(#2)

	
会員登録
-

	djangoデフォルトの会員登録を使用していたが、会員情報変更や、ユーザーごとに権限を変更することが出来ないため、カスタムユーザー作成を行った。
	
	まず、client(company)とcustomer(user)というアプリを作る。
	appのみにmodels.pyの記述を行った。
	models.pyのみにすべてを書くと量が多すぎるのでarticle,userに分けた。分けたので、models/init.pyに分けた所を読み込むように記述した。
	
	そして、templateや、forms.py,views.py,urls.pyは各アプリ毎に作成した。
	
	models.pyだけなぜappに作ったかというと、settings.pyでの記述の面倒さや、各アプリからテーブルを作成する記述をしてしまうと後々バラバラで困ってしまうから。
	
	ここから、会員登録のための記述をしていく。
	settings.pyに
	AUTH_USER_MODEL = 'app.User'を記述する。
	models/user.pyに会員登録に必要な記述をする。これでカスタムユーザーを作る宣言をした。
	customer/forms.pyに何をどのように表示させるかという記述をした。
	customer/views.pyに定義してあるformを使う事、成功した場合のリンク先、どこのリンクでその情報を表示させるかを記述。
	urls.pyにここまで書いたことを読んでもらうために、as_viewを記述した。
	メールの自動返信と退会手続きは少し時間がかかるため、後々追加していこうと思う。
	company側の会員登録はengine側がアカウントを作り、それを各社に与える。
	engine側はcreatesuperuserでアカウントを作り、管理する。
	
ログイン・ログアウト
-

	settings.pyに
	LOGIN_URL = 'app.login'
	LOGIN_REDIRECT_URL = '/'を記述する。
	
	customer/forms.pyにログインフォームの記述をした。
	labelにplacefolderが入るような記述も追加した。
	customer/views.pyにcustomer/forms.pyに書いたことを読み込ませる記述をした。
	customer/urls.pyにas_viewを記述。
	ログイン時の表示させるページと、ログアウト時の表示させるページを分けた。ログアウト時のユーザが設定をいじろうとすると、会員登録やログインが促されるようにした。(ほぼhtml側の記述)
	
会員登録情報変更
-

	customer/forms.pyに会員登録情報を変更するページでいじれることの指定をし、いじったものが会員登録情報に上書きされる記述をした。
	labelを日本語表記にしたり、placeholderの記述もした。
	customer/views.pyでもいつもどおり、formsで定義したことを読み込ませる記述をした。
	customer/urls.pyもas_viewをいつもどおり記述。
	しかし、これだけだと、パスワード変更が出来ず、パスワード変更欄にアルゴリズムという記述が出てしまい、その問題は少し時間がかかりそうだったため、最初はパスワード変更機能は無しでやる。
	会員情報変更欄からパスワード変更欄を消すのも少し時間がかかったが、Django2からはpassword = Noneという1行を足せば良いだけだった。

	
	
	
	
	